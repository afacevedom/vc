<!doctype html><html lang=en dir=ltr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Algoritmo de visibilización (Z-Buffer) #  Algoritmo Z-Buffer para el problema de visibilidad
El problema de visibilidad es el problema de decidir cuales elementos de una escena son visibles y cuales se &ldquo;esconden&rdquo;.
Definición #  Es un tipo de buffer de datos usados en computación grafica para representar información de la profundidad de los objetos en un espacio 3D desde una perspectiva particular. Los búferes de profundidad son una ayuda para renderizar una escena para garantizar que los correctos polígonos ocluyan correctamente otros polígonos.">
<meta name=theme-color content="#FFFFFF">
<meta name=color-scheme content="light dark"><meta property="og:title" content>
<meta property="og:description" content="Algoritmo de visibilización (Z-Buffer) #  Algoritmo Z-Buffer para el problema de visibilidad
El problema de visibilidad es el problema de decidir cuales elementos de una escena son visibles y cuales se &ldquo;esconden&rdquo;.
Definición #  Es un tipo de buffer de datos usados en computación grafica para representar información de la profundidad de los objetos en un espacio 3D desde una perspectiva particular. Los búferes de profundidad son una ayuda para renderizar una escena para garantizar que los correctos polígonos ocluyan correctamente otros polígonos.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://afacevedom.github.io/vc/docs/shortcodes/Workshop-Rendering/Algoritmo-de-Visibilidad/"><meta property="article:section" content="docs">
<meta property="article:modified_time" content="2022-02-07T23:09:56-05:00">
<title>Algoritmo De Visibilidad | Visual Computing</title>
<link rel=manifest href=/vc/manifest.json>
<link rel=icon href=/vc/favicon.png type=image/x-icon>
<link rel=stylesheet href=/vc/book.min.89a77f7e702a8626749b948bbfb01109823daf6c1246ca407d1378833494c402.css integrity="sha256-iad/fnAqhiZ0m5SLv7ARCYI9r2wSRspAfRN4gzSUxAI=" crossorigin=anonymous>
<script defer src=/vc/flexsearch.min.js></script>
<script defer src=/vc/en.search.min.1608fce46aec307692dfb8de21f7357425e8bb1eafff33a7a04b62ca5e331be0.js integrity="sha256-Fgj85GrsMHaS37jeIfc1dCXoux6v/zOnoEtiyl4zG+A=" crossorigin=anonymous></script>
</head>
<body dir=ltr>
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a class="flex align-center" href=/vc/><span>Visual Computing</span>
</a>
</h2>
<div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div>
<ul id=book-search-results></ul>
</div>
<ul>
<li class=book-section-flat>
<span>Shortcodes</span>
<ul>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/buttons/>Buttons</a>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/columns/>Columns</a>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/details/>Details</a>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/expand/>Expand</a>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/hints/>Hints</a>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/katex/>Katex</a>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/mermaid/>Mermaid</a>
</li>
<li>
<input type=checkbox id=section-ec67a64aba70b9df3d2a9acd6c92e3bc class=toggle>
<label for=section-ec67a64aba70b9df3d2a9acd6c92e3bc class="flex justify-between">
<a href=https://afacevedom.github.io/vc/docs/shortcodes/p5/>P5</a>
</label>
<ul>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/p5/div/>Div</a>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/p5/iframe/>Iframe</a>
</li>
</ul>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/tabs/>Tabs</a>
</li>
<li>
<input type=checkbox id=section-5e90dfc1cda674fda3ec0abb0b45bf6a class=toggle>
<label for=section-5e90dfc1cda674fda3ec0abb0b45bf6a class="flex justify-between">
<a href=https://afacevedom.github.io/vc/docs/shortcodes/team/>Team</a>
</label>
<ul>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/team/Andres-Acevedo/>Andres Acevedo</a>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/team/cesar/>Cesar</a>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/team/Cristian/>Cristian</a>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/team/felipe_jimenez/>Felipe Jimenez</a>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/team/iframe/>Iframe</a>
</li>
</ul>
</li>
<li>
<input type=checkbox id=section-a70aff46e05d97811e4b21900e332b88 class=toggle checked>
<label for=section-a70aff46e05d97811e4b21900e332b88 class="flex justify-between">
<a href=https://afacevedom.github.io/vc/docs/shortcodes/Workshop-Rendering/>Workshop Rendering</a>
</label>
<ul>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/Workshop-Rendering/Algoritmo-de-Rasterizaci%C3%B3n/>Algoritmo De Rasterización</a>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/Workshop-Rendering/Algoritmo-de-Visibilidad/ class=active>Algoritmo De Visibilidad</a>
</li>
</ul>
</li>
<li>
<input type=checkbox id=section-f403a5490b461b6d3b70d764cc23ed15 class=toggle>
<label for=section-f403a5490b461b6d3b70d764cc23ed15 class="flex justify-between">
<a href=https://afacevedom.github.io/vc/docs/shortcodes/Workshop-Final-Shaders/>Workshop Final Shaders</a>
</label>
<ul>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/Workshop-Final-Shaders/FotomosaicoHardware/>Fotomosaico Hardware</a>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/Workshop-Final-Shaders/FotomosaicoSoftware/>Fotomosaico Software</a>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/Workshop-Final-Shaders/Webcrawler/>Webcrawler</a>
</li>
</ul>
</li>
<li>
<a href=https://afacevedom.github.io/vc/docs/shortcodes/Workshop2/Webcrawler/>Webcrawler</a>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<a href=/vc/posts/>
Blog
</a>
</li>
</ul>
</nav>
<script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class=book-page>
<header class=book-header>
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/vc/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>Algoritmo De Visibilidad</strong>
<label for=toc-control>
<img src=/vc/svg/toc.svg class=book-icon alt="Table of Contents">
</label>
</div>
<aside class="hidden clearfix">
<nav id=TableOfContents>
<ul>
<li><a href=#algoritmo-de-visibilización-z-buffer>Algoritmo de visibilización (Z-Buffer)</a>
<ul>
<li><a href=#definición>Definición</a></li>
<li><a href=#usos>Usos</a></li>
<li><a href=#formula-matemáticaproyección-de-perspectiva>Formula matemática(proyección de perspectiva)</a></li>
<li><a href=#implementación>Implementación</a></li>
<li><a href=#referencias>Referencias</a></li>
</ul>
</li>
</ul>
</nav>
</aside>
</header>
<article class=markdown><h1 id=algoritmo-de-visibilización-z-buffer>
Algoritmo de visibilización (Z-Buffer)
<a class=anchor href=#algoritmo-de-visibilizaci%c3%b3n-z-buffer>#</a>
</h1>
<p>Algoritmo Z-Buffer para el problema de visibilidad</p>
<p>El problema de visibilidad es el problema de decidir cuales elementos de una escena son visibles y cuales se &ldquo;esconden&rdquo;.</p>
<h2 id=definición>
Definición
<a class=anchor href=#definici%c3%b3n>#</a>
</h2>
<p>Es un tipo de buffer de datos usados en computación grafica para representar información de la profundidad de los objetos en un espacio 3D desde una perspectiva particular. Los búferes de profundidad son una ayuda para renderizar una escena para garantizar que los correctos polígonos ocluyan correctamente otros polígonos. El almacenamiento en búfer Z fue descrito por primera vez en 1974 por Wolfgang Straßer en su tesis doctoral sobre algoritmos rápidos para renderizar objetos ocluidos. Una solución similar para determinar polígonos superpuestos es el algoritmo del pintor, que es capaz de manejar elementos de escena no opacos, aunque a costa de la eficiencia y los resultados incorrectos.</p>
<p>El búfer z tiene la misma estructura de datos interna que una imagen, es decir, una matriz 2d, con la única diferencia de que almacena un valor único para cada píxel de la pantalla en lugar de imágenes en color que usan 3 valores para crear color. Esto hace que el búfer z aparezca en blanco y negro porque no almacena información de color. El búfer tiene las mismas dimensiones que el búfer de pantalla para mantener la coherencia.</p>
<p>El Z-buffer tiene la misma estructura de datos interna que una imagen, es decir, una matriz 2d, con la única diferencia de que almacena un valor único para cada píxel de la pantalla en lugar de imágenes en color que usan 3 valores para crear color. Esto hace que el búfer z aparezca en blanco y negro porque no almacena información de color. El búfer tiene las mismas dimensiones que el búfer de pantalla para mantener la coherencia.</p>
<h2 id=usos>
Usos
<a class=anchor href=#usos>#</a>
</h2>
<p>El Z-buffer es una tecnología utilizada en casi todas las computadoras, portátiles y teléfonos móviles contemporáneos para realizar gráficos de computadora en 3D . El uso principal ahora es para videojuegos, que requieren un procesamiento rápido y preciso de escenas 3D. El Z-buffer se implementa en hardware dentro de las tarjetas gráficas. El Z-buffer también se utiliza (implementado como software en lugar de hardware) para producir efectos especiales generados por computadora para películas.</p>
<h2 id=formula-matemáticaproyección-de-perspectiva>
Formula matemática(proyección de perspectiva)
<a class=anchor href=#formula-matem%c3%a1ticaproyecci%c3%b3n-de-perspectiva>#</a>
</h2>
<script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/addons/p5.sound.min.js></script>
<script src=/vc/sketches/Matebuffer.js></script>
<div id=Matebuffer></div>
<h2 id=implementación>
Implementación
<a class=anchor href=#implementaci%c3%b3n>#</a>
</h2>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tpl data-lang=tpl>class Shape <span style=color:#75715e>{</span>
  <span style=color:#a6e22e>constructor</span><span style=color:#f92672>(</span><span style=color:#a6e22e>vertices</span><span style=color:#f92672>)</span> <span style=color:#75715e>{</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>vertices</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vertices</span><span style=color:#f92672>;</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>pickRandomPosition</span><span style=color:#f92672>();</span>
    <span style=color:#f92672>//</span> <span style=color:#a6e22e>store</span> <span style=color:#a6e22e>initial</span> <span style=color:#a6e22e>random</span> <span style=color:#a6e22e>props</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>x</span><span style=color:#f92672>;</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>y</span><span style=color:#f92672>;</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curRadius</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>radius</span><span style=color:#f92672>;</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curFill</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>fill</span><span style=color:#f92672>;</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curRot</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>rotation</span><span style=color:#f92672>;</span>
  <span style=color:#75715e>}</span>
    <span style=color:#a6e22e>pickRandomPosition</span><span style=color:#f92672>()</span> <span style=color:#75715e>{</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>random</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>,</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>);</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>random</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>,</span> <span style=color:#a6e22e>height</span><span style=color:#f92672>);</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>radius</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>random</span><span style=color:#f92672>(</span><span style=color:#ae81ff>20</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>100</span><span style=color:#f92672>);</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>fill</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>random</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>255</span><span style=color:#f92672>);</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>rotation</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>random</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>,</span> <span style=color:#a6e22e>TWO_PI</span><span style=color:#f92672>);</span>
  <span style=color:#75715e>}</span>
  
  <span style=color:#a6e22e>display</span><span style=color:#f92672>()</span> <span style=color:#75715e>{</span>
    <span style=color:#f92672>//</span> <span style=color:#a6e22e>lerp</span> <span style=color:#a6e22e>values</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>lerp</span><span style=color:#f92672>(</span><span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curX</span><span style=color:#f92672>,</span> <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>x</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0.1</span><span style=color:#f92672>);</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>lerp</span><span style=color:#f92672>(</span><span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curY</span><span style=color:#f92672>,</span> <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>y</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0.1</span><span style=color:#f92672>);</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curRadius</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>lerp</span><span style=color:#f92672>(</span><span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curRadius</span><span style=color:#f92672>,</span> <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>radius</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0.1</span><span style=color:#f92672>);</span>
    <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curRot</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>lerp</span><span style=color:#f92672>(</span><span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curRot</span><span style=color:#f92672>,</span> <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>rotation</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0.1</span><span style=color:#f92672>);</span>
    
    <span style=color:#f92672>//</span> <span style=color:#a6e22e>draw</span> <span style=color:#a6e22e>poly</span>
    <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>segmentRadians</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>TWO_PI</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>vertices</span><span style=color:#f92672>;</span>
    <span style=color:#a6e22e>fill</span><span style=color:#f92672>(</span><span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>fill</span><span style=color:#f92672>);</span>
    <span style=color:#a6e22e>push</span><span style=color:#f92672>();</span>
    <span style=color:#a6e22e>translate</span><span style=color:#f92672>(</span><span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curX</span><span style=color:#f92672>,</span> <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curY</span><span style=color:#f92672>);</span>
    <span style=color:#a6e22e>rotate</span><span style=color:#f92672>(</span><span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>curRot</span><span style=color:#f92672>);</span>
    <span style=color:#a6e22e>beginShape</span><span style=color:#f92672>();</span>
    <span style=color:#a6e22e>for</span><span style=color:#f92672>(</span><span style=color:#a6e22e>let</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>vertices</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>++)</span> <span style=color:#75715e>{</span>
      <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cos</span><span style=color:#f92672>(</span><span style=color:#a6e22e>i</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>segmentRadians</span><span style=color:#f92672>)</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>radius</span><span style=color:#f92672>;</span>
      <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sin</span><span style=color:#f92672>(</span><span style=color:#a6e22e>i</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>segmentRadians</span><span style=color:#f92672>)</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>radius</span><span style=color:#f92672>;</span>
      <span style=color:#a6e22e>vertex</span><span style=color:#f92672>(</span><span style=color:#a6e22e>x</span><span style=color:#f92672>,</span> <span style=color:#a6e22e>y</span><span style=color:#f92672>);</span>
    <span style=color:#75715e>}</span>
    <span style=color:#a6e22e>endShape</span><span style=color:#f92672>(</span><span style=color:#a6e22e>CLOSE</span><span style=color:#f92672>);</span>
    <span style=color:#a6e22e>pop</span><span style=color:#f92672>();</span>
  <span style=color:#75715e>}</span>
<span style=color:#75715e>}</span>

let shapesArray = [];
let numShapes = 0;

let polygons = [];
let shape =[];
let bg = 0;
let curBg = 0;

function setup() <span style=color:#75715e>{</span>
  <span style=color:#a6e22e>createCanvas</span><span style=color:#f92672>(</span><span style=color:#a6e22e>windowWidth</span><span style=color:#f92672>,</span> <span style=color:#a6e22e>windowHeight</span><span style=color:#f92672>);</span>
  <span style=color:#a6e22e>for</span><span style=color:#f92672>(</span><span style=color:#a6e22e>let</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>20</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>++)</span> <span style=color:#75715e>{</span>
    <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>vertices</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>round</span><span style=color:#f92672>(</span><span style=color:#a6e22e>random</span><span style=color:#f92672>(</span><span style=color:#ae81ff>3</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>6</span><span style=color:#f92672>));</span>
    <span style=color:#a6e22e>shapesArray</span><span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span><span style=color:#a6e22e>new</span> <span style=color:#a6e22e>Shape</span><span style=color:#f92672>(</span><span style=color:#a6e22e>vertices</span><span style=color:#f92672>));</span>
  <span style=color:#75715e>}</span>
  <span style=color:#a6e22e>for</span><span style=color:#f92672>(</span><span style=color:#a6e22e>let</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>++)</span><span style=color:#75715e>{</span>
    <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>round</span><span style=color:#f92672>(</span><span style=color:#a6e22e>random</span><span style=color:#f92672>(</span><span style=color:#ae81ff>1</span><span style=color:#f92672>,</span><span style=color:#ae81ff>255</span><span style=color:#f92672>));</span>
    <span style=color:#a6e22e>shape</span><span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span><span style=color:#a6e22e>x</span><span style=color:#f92672>);</span>
    <span style=color:#a6e22e>for</span><span style=color:#f92672>(</span><span style=color:#a6e22e>let</span> <span style=color:#a6e22e>h</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>h</span><span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>h</span><span style=color:#f92672>++)</span><span style=color:#75715e>{</span>
      <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>round</span><span style=color:#f92672>(</span><span style=color:#a6e22e>random</span><span style=color:#f92672>(</span><span style=color:#ae81ff>1</span><span style=color:#f92672>,</span><span style=color:#ae81ff>255</span><span style=color:#f92672>));</span>
      <span style=color:#a6e22e>shape</span><span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span><span style=color:#a6e22e>y</span><span style=color:#f92672>);</span>
      <span style=color:#a6e22e>for</span><span style=color:#f92672>(</span><span style=color:#a6e22e>let</span> <span style=color:#a6e22e>j</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>j</span><span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>j</span><span style=color:#f92672>++)</span><span style=color:#75715e>{</span>
        <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>z</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>round</span><span style=color:#f92672>(</span><span style=color:#a6e22e>random</span><span style=color:#f92672>(</span><span style=color:#ae81ff>1</span><span style=color:#f92672>,</span><span style=color:#ae81ff>255</span><span style=color:#f92672>));</span>
        <span style=color:#a6e22e>shape</span><span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span><span style=color:#a6e22e>z</span><span style=color:#f92672>);</span>
        <span style=color:#a6e22e>for</span><span style=color:#f92672>(</span><span style=color:#a6e22e>let</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>++)</span><span style=color:#75715e>{</span>
          <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>depth</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>round</span><span style=color:#f92672>(</span><span style=color:#a6e22e>random</span><span style=color:#f92672>(</span><span style=color:#ae81ff>1</span><span style=color:#f92672>,</span><span style=color:#ae81ff>255</span><span style=color:#f92672>));</span>    
          <span style=color:#a6e22e>shape</span><span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span><span style=color:#a6e22e>depth</span><span style=color:#f92672>);</span>
        <span style=color:#75715e>}</span>
      <span style=color:#75715e>}</span>
    <span style=color:#75715e>}</span>
  <span style=color:#a6e22e>polygons</span><span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span><span style=color:#a6e22e>shape</span><span style=color:#f92672>);</span>
  <span style=color:#75715e>}</span>
  
<span style=color:#75715e>}</span>
function zBuffer(polygons) <span style=color:#75715e>{</span>
  <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>zBufferArray</span> <span style=color:#f92672>=</span> <span style=color:#f92672>[];</span>
  <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>colorArray</span> <span style=color:#f92672>=</span> <span style=color:#f92672>[];</span>
  <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>pixelRow</span> <span style=color:#f92672>=</span> <span style=color:#f92672>[];</span>
  
  <span style=color:#f92672>/*</span> <span style=color:#a6e22e>Initialize</span> <span style=color:#a6e22e>arrays</span> <span style=color:#f92672>*/</span>
  <span style=color:#a6e22e>for</span> <span style=color:#f92672>(</span><span style=color:#a6e22e>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>windowHeight</span><span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>)</span> <span style=color:#75715e>{</span>
    <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>bufferRow</span> <span style=color:#f92672>=</span> <span style=color:#f92672>[];</span>
    <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>colorRow</span> <span style=color:#f92672>=</span> <span style=color:#f92672>[];</span>
    <span style=color:#a6e22e>for</span> <span style=color:#f92672>(</span><span style=color:#a6e22e>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>windowWidth</span><span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>)</span> <span style=color:#75715e>{</span>
      <span style=color:#a6e22e>bufferRow</span><span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span><span style=color:#a6e22e>Infinity</span><span style=color:#f92672>);</span>
      <span style=color:#a6e22e>colorRow</span><span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span><span style=color:#a6e22e>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>backgroundColor</span><span style=color:#f92672>);</span>
    <span style=color:#75715e>}</span>
    <span style=color:#a6e22e>zBufferArray</span><span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span><span style=color:#a6e22e>bufferRow</span><span style=color:#f92672>);</span>
    <span style=color:#a6e22e>colorArray</span><span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span><span style=color:#a6e22e>colorRow</span><span style=color:#f92672>);</span>
  <span style=color:#75715e>}</span>

  <span style=color:#f92672>//</span> <span style=color:#a6e22e>Iterate</span> <span style=color:#a6e22e>over</span> <span style=color:#a6e22e>all</span> <span style=color:#a6e22e>polygons</span>
  <span style=color:#a6e22e>for</span> <span style=color:#f92672>(</span><span style=color:#a6e22e>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>polygons</span><span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>)</span> <span style=color:#75715e>{</span>
    <span style=color:#a6e22e>let</span> <span style=color:#a6e22e>polygon</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>polygons</span><span style=color:#f92672>[</span><span style=color:#a6e22e>i</span><span style=color:#f92672>];</span>
    <span style=color:#a6e22e>for</span> <span style=color:#f92672>(</span><span style=color:#a6e22e>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>polygon</span><span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>)</span> <span style=color:#75715e>{</span>
      <span style=color:#a6e22e>pixelRow</span><span style=color:#f92672>.</span><span style=color:#a6e22e>push</span><span style=color:#f92672>(</span><span style=color:#a6e22e>polygon</span><span style=color:#f92672>[</span><span style=color:#a6e22e>j</span><span style=color:#f92672>]);</span>
      <span style=color:#a6e22e>for</span> <span style=color:#f92672>(</span><span style=color:#a6e22e>let</span> <span style=color:#a6e22e>k</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>k</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>k</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>)</span> <span style=color:#75715e>{</span>
        <span style=color:#f92672>//</span> <span style=color:#a6e22e>Check</span> <span style=color:#a6e22e>z</span><span style=color:#f92672>-</span><span style=color:#a6e22e>depth</span> <span style=color:#a6e22e>of</span> <span style=color:#a6e22e>pixel</span>
        <span style=color:#a6e22e>if</span> <span style=color:#f92672>(</span><span style=color:#a6e22e>pixelRow</span><span style=color:#f92672>[</span><span style=color:#a6e22e>k</span><span style=color:#f92672>][</span><span style=color:#ae81ff>3</span><span style=color:#f92672>]</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>zBufferArray</span><span style=color:#f92672>[</span><span style=color:#a6e22e>j</span><span style=color:#f92672>][</span><span style=color:#a6e22e>k</span><span style=color:#f92672>])</span> <span style=color:#75715e>{</span>
          <span style=color:#a6e22e>zBufferArray</span><span style=color:#f92672>[</span><span style=color:#a6e22e>j</span><span style=color:#f92672>][</span><span style=color:#a6e22e>k</span><span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>pixelRow</span><span style=color:#f92672>[</span><span style=color:#a6e22e>k</span><span style=color:#f92672>][</span><span style=color:#ae81ff>3</span><span style=color:#f92672>];</span>
          <span style=color:#a6e22e>colorArray</span><span style=color:#f92672>[</span><span style=color:#a6e22e>j</span><span style=color:#f92672>][</span><span style=color:#a6e22e>k</span><span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>pixelRow</span><span style=color:#f92672>[</span><span style=color:#a6e22e>k</span><span style=color:#f92672>];</span>
        <span style=color:#75715e>}</span>
      <span style=color:#75715e>}</span>
    <span style=color:#75715e>}</span>
  <span style=color:#75715e>}</span>
  <span style=color:#a6e22e>console</span><span style=color:#f92672>.</span><span style=color:#a6e22e>log</span><span style=color:#f92672>(</span><span style=color:#a6e22e>colorArray</span><span style=color:#f92672>)</span>
  <span style=color:#a6e22e>return</span> <span style=color:#a6e22e>colorArray</span><span style=color:#f92672>;</span>
<span style=color:#75715e>}</span>

function draw()<span style=color:#75715e>{</span>
  <span style=color:#a6e22e>background</span><span style=color:#f92672>(</span><span style=color:#ae81ff>255</span><span style=color:#f92672>);</span>
  
  <span style=color:#a6e22e>for</span><span style=color:#f92672>(</span><span style=color:#a6e22e>let</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>shapesArray</span><span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>++)</span> <span style=color:#75715e>{</span>
    <span style=color:#a6e22e>shapesArray</span><span style=color:#f92672>[</span><span style=color:#a6e22e>i</span><span style=color:#f92672>].</span><span style=color:#a6e22e>display</span><span style=color:#f92672>();</span>
  <span style=color:#75715e>}</span>
<span style=color:#75715e>}</span>

function mouseClicked() <span style=color:#75715e>{</span>
  <span style=color:#a6e22e>zBuffer</span><span style=color:#f92672>(</span><span style=color:#a6e22e>polygons</span><span style=color:#f92672>);</span>
  <span style=color:#a6e22e>for</span><span style=color:#f92672>(</span><span style=color:#a6e22e>let</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>shapesArray</span><span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>++)</span> <span style=color:#75715e>{</span>
    <span style=color:#a6e22e>shapesArray</span><span style=color:#f92672>[</span><span style=color:#a6e22e>i</span><span style=color:#f92672>].</span><span style=color:#a6e22e>pickRandomPosition</span><span style=color:#f92672>();</span>
  <span style=color:#75715e>}</span>
  <span style=color:#a6e22e>bg</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>random</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>255</span><span style=color:#f92672>);</span>
<span style=color:#75715e>}</span>
</code></pre></div>
<iframe id=breath style=width:700px;height:700px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/addons/p5.sound.min.js></script>
            
            
            
            
            
            <script>
              
class Shape {
  constructor(vertices) {
    this.vertices = vertices;
    this.pickRandomPosition();
    // store initial random props
    this.curX = this.x;
    this.curY = this.y;
    this.curRadius = this.radius;
    this.curFill = this.fill;
    this.curRot = this.rotation;
  }
  
  pickRandomPosition() {
    this.x = random(0, width);
    this.y = random(0, height);
    this.radius = random(20, 100);
    this.fill = random(0, 255);
    this.rotation = random(0, TWO_PI);
  }
  
  display() {
    // lerp values
    this.curX = lerp(this.curX, this.x, 0.1);
    this.curY = lerp(this.curY, this.y, 0.1);
    this.curRadius = lerp(this.curRadius, this.radius, 0.1);
    this.curRot = lerp(this.curRot, this.rotation, 0.1);
    
    // draw poly
    let segmentRadians = TWO_PI / this.vertices;
    fill(this.fill);
    push();
    translate(this.curX, this.curY);
    rotate(this.curRot);
    beginShape();
    for(let i=0; i < this.vertices; i++) {
      let x = cos(i * segmentRadians) * this.radius;
      let y = sin(i * segmentRadians) * this.radius;
      vertex(x, y);
    }
    endShape(CLOSE);
    pop();
  }
}

let shapesArray = [];
let numShapes = 0;

let polygons = [];
let shape =[];
let bg = 0;
let curBg = 0;

function setup() {
  createCanvas(windowWidth, windowHeight);
  for(let i=0; i < 20; i++) {
    let vertices = round(random(3, 6));
    shapesArray.push(new Shape(vertices));
  }
  for(let i=0; i< 1; i++){
    let x = round(random(1,255));
    shape.push(x);
    for(let h=0; h< 1; h++){
      let y = round(random(1,255));
      shape.push(y);
      for(let j=0; j< 1; j++){
        let z = round(random(1,255));
        shape.push(z);
        for(let i=0; i< 1; i++){
          let depth = round(random(1,255));    
          shape.push(depth);
        }
      }
    }
  polygons.push(shape);
  }
  
}
function zBuffer(polygons) {
  let zBufferArray = [];
  let colorArray = [];
  let pixelRow = [];
  
  /* Initialize arrays */
  for (let i = 0; i < windowHeight.length; i += 1) {
    let bufferRow = [];
    let colorRow = [];
    for (let j = 0; j < windowWidth.length; j += 1) {
      bufferRow.push(Infinity);
      colorRow.push(this.backgroundColor);
    }
    zBufferArray.push(bufferRow);
    colorArray.push(colorRow);
  }

  // Iterate over all polygons
  for (let i = 0; i < polygons.length; i += 1) {
    let polygon = polygons[i];
    for (let j = 0; j < polygon.length; j += 1) {
      pixelRow.push(polygon[j]);
      for (let k = 0; k < 4; k += 1) {
        // Check z-depth of pixel
        if (pixelRow[k][3] < zBufferArray[j][k]) {
          zBufferArray[j][k] = pixelRow[k][3];
          colorArray[j][k] = pixelRow[k];
        }
      }
    }
  }
  console.log(colorArray)
  return colorArray;
}

function draw(){
  background(255);
  
  for(let i=0; i < shapesArray.length; i++) {
    shapesArray[i].display();
  }
}

function mouseClicked() {
  <!-- zBuffer(polygons); -->
  for(let i=0; i < shapesArray.length; i++) {
    shapesArray[i].pickRandomPosition();
  }
  bg = random(0, 255);
}

            </script>
          </head>
          <body>
          </body>
        </html>
      "></iframe>
<h2 id=referencias>
Referencias
<a class=anchor href=#referencias>#</a>
</h2>
<p><a href=https://www.davepagurek.com/blog/depth-of-field/>https://www.davepagurek.com/blog/depth-of-field/</a></p>
</article>
<footer class=book-footer>
<div class="flex flex-wrap justify-between">
<div><a class="flex align-center" href=https://github.com/afacevedom/vc/commit/fce9cb52b0113b6f2ed79c9f0de2619bd14e3ffd title="Last modified by afacevedom | February 8, 2022" target=_blank rel=noopener>
<img src=/vc/svg/calendar.svg class=book-icon alt=Calendar>
<span>February 8, 2022</span>
</a>
</div>
</div>
<script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>
</footer>
<div class=book-comments>
</div>
<label for=menu-control class="hidden book-menu-overlay"></label>
</div>
<aside class=book-toc>
<div class=book-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#algoritmo-de-visibilización-z-buffer>Algoritmo de visibilización (Z-Buffer)</a>
<ul>
<li><a href=#definición>Definición</a></li>
<li><a href=#usos>Usos</a></li>
<li><a href=#formula-matemáticaproyección-de-perspectiva>Formula matemática(proyección de perspectiva)</a></li>
<li><a href=#implementación>Implementación</a></li>
<li><a href=#referencias>Referencias</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</aside>
</main>
</body>
</html>